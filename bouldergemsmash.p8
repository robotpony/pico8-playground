pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
-- boulder gem smash

function _init()
 t={}
 t.now=time()
 t.last=t.now
	t.tick=0
	mode=0
	
	map_init()
	player_init()
end

function _update()
	t.now=time()
	if(t.now>(t.last+1)) then
		t.tick=(t.tick+1)%2
		t.last=t.now
	end
	
	player_move()
end

function debug_bar()
	?t.tick,8,1,0
	?p.frame,16,1,0
end

function _draw()
	cls()
	map_draw()
	player_draw()
	
	debug_bar()
	
end
-->8
-- map

function map_init()
 -- tile bits
	solid=0
	lock=1
	falls=2
	triggers=3
	destroys=4
	ani=5
	hpinc=6
	hpdec=7
	
	-- 
	level=0
	tutorial=1
end

function map_draw()
 map(0,0,0,0,128,128)
end

function is_tile(tile_t,x,y)
	tile=mget(x,y)
	return fget(tile,tile_t)
end

function can_move_to(x,y)
	return not is_tile(solid,x,y)
end
-->8
-- player

function player_init()

	p={}
	--
	p.x=1
	p.y=1
	-- r,l,d,u
	p.sprites={1,17,33,49}
	p.sprite=p.sprites[1]
end

function player_draw()
	spr(p.sprite+t.tick,p.x*8,p.y*8)
end

function player_move()

	nx=0
	ny=0
	
	if (btnp(⬅️)) nx=-1
	if (btnp(➡️)) nx=1
	if (btnp(⬆️)) ny=-1
	if (btnp(⬇️)) ny=1
	
	if (can_move_to(p.x+nx,p.y+ny)) then
	 p.x=mid(0,nx+p.x,127)
	 p.y=mid(0,ny+p.y,127)
	 
	 mset(p.x,p.y,0)
	 set_p_sprite(nx,ny)
	 
	else
	 sfx(1)
	end
end

function set_p_sprite(nx,ny)
	if(nx==1) p.sprite=p.sprites[1]
	if(nx==-1) p.sprite=p.sprites[2]
	if(ny==1) p.sprite=p.sprites[3]
	if(ny==-1) p.sprite=p.sprites[4]
end
__gfx__
0000000006770000067700004444444444444444444944444441144444444444444444444444444444444444444444440000000000000e00008e0e0854444445
0000000067777700677777009949994999499949444444444115514444461444444794444446e4444884488444444444000000000000000080e0088049999994
007007006c0c0c006c0c0c0044444444444444444444494415555514446cc144447aa94444688e448888878844444444000008000e00e80e4e08e80e49944994
0007700067777500677770504999499949955599944444441556551446cccc1447aaaa94468888e48888887855544444000800000008e0008008e40855500555
0007700006555550067555554444444444450544444444441565565146cccc1447aaaa94468888e4888888885055555400008000000e8000084e880049444494
00700700677775006777705099499949994555494449444441555551446cc144447aa94444688e44488888845554455400800000e08e00e0e88ee0e449499494
0000000007007000070070004444444444444444444444444155111444461444444794444446e44444888844444444440000000000000000008008e049499494
0000000007707700077077004999499949994999494444944411444444444444444444444444444444488444444444440000000000e0000080e8e00844444444
2222eeee00007760000077605555555555555555555d555555511555555555555555555555555555555555555555555500000000000000000009000000000000
2552e66e0077777600777776dd5ddd5ddd5ddd5d55555555511dd15555561555555795555556e555588558855555555500000000000000000909909000000000
2555666e00c0c0c600c0c0c6555555555555555555555d551ddddd15556cc155557aa95555688e5588888788555555550000000000a00a0000a00a00000aa000
2252e6ee00577776050777765ddd5ddd5dd111ddd55555551dd6dd1556cccc1557aaaa95568888e588888878ddd55555000a0000000a9000990a909000a99400
ee6e252205555560555557605555555555510155555555551d6dd6d156cccc1557aaaa95568888e588888888d0ddddd50000a0000009a0000909a09900a99400
e66655520057777605077776dd5ddd5ddd51115d555d555551ddddd1556cc155557aa95555688e5558888885ddd55dd50000000000a00a0000a00a0000044000
e66e2552000700700007007055555555555555555555555551dd111555561555555795555556e555558888555555555500000000000000000909909000000000
eeee222200770770007707705ddd5ddd5ddd5ddd555555d555115555555555555555555555555555555885555555555500000000000000000000900000000000
3333bbbb06660600066606001111111111111111ddd1ddddddd44ddddddddddddddddddddddddddddddddddddddddddd00000000000000000000000000000000
3553b66b67c7677767c76777dd1ddd1ddd1ddd1dd1ddddddd44994ddddd61dddddd79dddddd6edddd88dd88ddddddddd00000000000000000007070000000000
3555666b77075707770777071111111111111111ddddd1dd4999994ddd6cc1dddd7aa9dddd688edd88888788dddddddd000000000000c0000c00c0000dd00000
3353b6bb77c7570077c757001ddd1ddd1dd555dd1ddddddd4994994dd6cccc1dd7aaaa9dd68888ed88888878555ddddd00007000007c7000007c7c00d55ddddd
bb6b353307075777070757771111111111150511dddddd1d49499494d6cccc1dd7aaaa9dd68888ed888888885055555d000700000007c70000c7c700d5555555
b666555307c5550707c05007dd1ddd1ddd15551dddd1ddddd4999994dd6cc1dddd7aa9dddd688eddd888888d555dd55d00000000000c0000000c00c005500505
b66b355300005000000555001111111111111111ddddddddd499444dddd61dddddd79dddddd6eddddd8888dddddddddd00000000000000000070700000000000
bbbb333300000000000050001ddd1ddd1ddd1dddd1dddd1ddd44ddddddddddddddddddddddddddddddd88ddddddddddd00000000000000000000000000000000
1111cccc00000000000500003333333333333333333d333333344333333333333333333333333333333333333333333300000000000000000c0000078e8e8e8e
1551c66c0005000000555000dd3ddd3ddd3ddd3d3d3333333449943333361333333793333336e3333883388333333333000000000000007006cc007c8e8e8e8e
1555666c70555c7070050c70333333333333333333333d3349999943336cc133337aa93333688e338888878833333333000000000061c7000061c7c066666666
1151c6cc77757070777570703ddd3ddd3dd555ddd33333334994994336cccc1337aaaa93368888e388888878555333330006700000c6710000c671c055566555
cc6c151100757c7700757c773333333333350533333333d34949949436cccc1337aaaa93368888e388888888505555530007600000176c000c176c0065655656
c66655517075707770777077dd3ddd3ddd35553d333d333334999994336cc133337aa93333688e33388888835553355300000000007c16000c7c160065655656
c66c155177767c7677767c763333333333333333333333333499444333361333333793333336e33333888833333333330000000007000000c700cc608e8e8e8e
cccc111100606660006066603ddd3ddd3ddd3ddd3d3333d33344333333333333333333333333333333388333333333330000000000000000700000c08e8e8e8e
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513030303030303030303030303030
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513051515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513051515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513051515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513051515151515151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513051515151303030303030304030
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513051515151305151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513051515151305151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513051515151305151515151515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513051515151305151513030303030
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513051515151305151513051515130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151513051515151305151513051015130
30515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151
51515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151514051515151305151514051515130
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030
__gff__
0000000103001d0000004000000000000800000103001d0000004000000000000800000103001d0000004000000000000800000103001d00000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303
0315151515150315151616161515031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315301515150315161616161615031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515150315161616161616031515151515151504151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515150315161619161616031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
03150f1515150315161619161616031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515150415171819151515031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0303030303030315171819151515031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515193f19151515031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515183f18151a15031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
031b151515151515173f17151515031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0303030303030303030303030303031515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151503151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0303030304030303030303030303030303030303030303151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151515151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151515151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151515151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151515151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151515151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151515151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151515151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151515151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151515151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151515151515151515151515031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0303030303030303030303030303030303030303030303030303030303030303031515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
0315151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151503
__sfx__
380100000c350133502b3501f33011320073100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2e0400000605000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
